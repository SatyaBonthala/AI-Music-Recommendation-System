# Spotify Songs Recommendation using GNN

This project implements a Graph Neural Network (GNN) based recommendation system for Spotify songs. It constructs a bipartite graph of playlists and tracks from a CSV file and uses PyTorch Geometric to train the model and generate song recommendations.

## Project Overview

The main ideas behind this project are:

-   **Graph Construction:** Extract playlists and track nodes from the `spotify_songs.csv` file. Each edge in the graph represents a track's inclusion in a playlist.
-   **Node Features:** Playlist nodes are initialized with zeros while track nodes are assigned audio feature vectors derived from the CSV (e.g., danceability, energy, tempo).
-   **Model Definition:** A two-layer Graph Convolutional Network (GCN) is used for learning node embeddings.
-   **Training:** The model is trained using a pairwise loss function with negative sampling to rank true playlist–track pairs higher.
-   **Inference:** Recommendations are generated by computing and ranking the similarity of track embeddings for a queried playlist or track.

## Project Structure

-   **`.gitignore`** – Specifies files and directories to be ignored by Git.
-   **`spotify_songs.csv`** – The dataset containing Spotify track details along with playlist information.
-   **`h1.ipynb`** – Jupyter Notebook that covers data loading, graph construction, model training, and inference (recommendations).
-   **`h1.md`** – Markdown file detailing the data processing, GNN architecture and training steps.
-   **`h2.ipynb`** – Another Jupyter Notebook that also demonstrates model training and an interactive song recommendation session.
-   **`h2.py`** – A Python script that implements similar functionalities (data loading, graph building, model definition, and training) in a script format.
-   **`ml-system-recommendation-knn-spotify.ipynb`** – Notebook that may include benchmarking or experimentation with kNN for song recommendations.
-   **`README.md`** – This file.

## Requirements

Make sure you have the following installed:

-   Python 3.10+
-   PyTorch
-   PyTorch Geometric
-   pandas
-   numpy

You can install the required packages with:

```sh
pip install pandas numpy torch torch-geometric
```

## Setup & Usage

1. **Clone the Repository:**

    ```sh
    git clone https://github.com/SatyaBonthala/SIC_Project
    cd SIC_Project
    ```

2. **Prepare the Data:**

    Ensure that `spotify_songs.csv` is in the root directory. This CSV file should include columns such as `track_id`, `track_name`, and various audio features:

    - danceability
    - energy
    - key
    - loudness
    - mode
    - speechiness
    - acousticness
    - instrumentalness
    - liveness
    - valence
    - tempo
    - duration_ms

3. **Running the Notebooks:**

    Open either `h1.ipynb` or `h2.ipynb` in Visual Studio Code’s Jupyter Notebook interface to examine the steps:

    - Data loading and graph construction.
    - Model definition and training.
    - Inference for generating recommendations.

4. **Running the Python Script:**

    Alternatively, you can run the Python script `h2.py` from the command line:

    ```sh
    python h2.py
    ```

    This script will load the dataset, build the graph, train the GNN model, and print out recommendation results.

## Training the Model

-   **Graph Construction:** Both notebooks and the script read `spotify_songs.csv`to create node features and the graph connectivity (`edge_index`).

-   **Model Training:** The training loop uses positive pairs extracted from playlist-track relationships and samples negative pairs randomly. The loss is computed as a combination of positive and negative sample losses.
-   **Logging:** Intermediate losses are printed every 10 epochs (as shown in `h1.md` and `h1.ipynb`).

## Inference & Recommendations

-   After training, embed all nodes using the trained GNN.
-   For a given playlist or track, the top-10 similar songs are determined by ranking the similarity of node embeddings.
-   The inference code is available in both notebooks. For example, `h1.md` details how to compute recommendation scores using dot products between embeddings.

## Experimentation

-   The project includes an interactive recommendation session in `h2.ipynb` where you can input a song name and get similar song recommendations.
-   A separate notebook, `ml-system-recommendation-knn-spotify.ipynb`, might be used for experimenting with alternative recommendation algorithms such as k-Nearest Neighbors (kNN).

## Acknowledgements

This project uses [PyTorch](https://pytorch.org) and [PyTorch Geometric](https://pytorch-geometric.readthedocs.io) for model implementation as well as pandas and numpy for data processing.

---

For any additional questions or issues, please file an issue or contact the maintainer.
